<Window x:Class="ConcentradoKPI.App.Views.PersonalVigenteWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Personal vigente"
        Width="1100" Height="700"
        WindowStartupLocation="CenterOwner">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="48"/>
            <!-- Barra superior -->
            <RowDefinition Height="*"/>
            <!-- Contenido scroll -->
        </Grid.RowDefinitions>

        <!-- Barra superior (estilo MainWindow) -->
        <DockPanel Grid.Row="0" Background="#11254a" LastChildFill="False">
            <TextBlock Margin="16,0"
                       FontSize="18"
                       FontWeight="Bold"
                       Foreground="White"
                       VerticalAlignment="Center"
                       DockPanel.Dock="Left">
                <Run Text="Personal vigente — "/>
                <Run Text="{Binding Company.Name}"/>
                <Run Text=" — Proyecto: "/>
                <Run Text="{Binding Project.Name}"/>
                <Run Text=" | Semana "/>
                <Run Text="{Binding Week.WeekNumber}"/>
            </TextBlock>
        </DockPanel>

        <!-- Contenido con scroll -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="16" Orientation="Vertical">

                <!-- Formulario superior -->
                <Border Padding="12" BorderBrush="#E2E8F0" BorderThickness="1" CornerRadius="6" Background="White">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1.5*"/>
                            <ColumnDefinition Width="1.2*"/>
                            <ColumnDefinition Width="1.2*"/>
                            <ColumnDefinition Width="1.2*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Fila 1 -->
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Razón Social de la Compañía Contratista:" VerticalAlignment="Center"/>
                        <TextBox   Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3"
                                   Text="{Binding RazonSocial, UpdateSourceTrigger=PropertyChanged}"
                                   Margin="8,4,0,4"/>

                        <!-- Fila 2 -->
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Nombre del Responsable de la Obra o Servicio:" VerticalAlignment="Center"/>
                        <TextBox   Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"
                                   Text="{Binding ResponsableObra, UpdateSourceTrigger=PropertyChanged}"
                                   Margin="8,4,0,4"/>

                        <!-- Fila 3 -->
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Registro Patronal IMSS:" VerticalAlignment="Center"/>
                        <TextBox   Grid.Row="2" Grid.Column="1" 
                                   Text="{Binding RegistroIMSS, UpdateSourceTrigger=PropertyChanged}"
                                   Margin="8,4,12,4"/>

                        <TextBlock Grid.Row="2" Grid.Column="2" Text="Fecha:" VerticalAlignment="Center"/>
                        <DatePicker Grid.Row="2" Grid.Column="3"
                                    SelectedDate="{Binding Fecha, UpdateSourceTrigger=PropertyChanged}"
                                    Margin="8,4,0,4"/>

                        <!-- Fila 4 -->
                        <TextBlock Grid.Row="3" Grid.Column="0" Text="RFC de la Compañía:" VerticalAlignment="Center"/>
                        <TextBox   Grid.Row="3" Grid.Column="1"
                                   Text="{Binding RFCCompania, UpdateSourceTrigger=PropertyChanged}"
                                   Margin="8,4,12,4"/>

                        <TextBlock Grid.Row="3" Grid.Column="2" Text="Número de Proveedor:" VerticalAlignment="Center"/>
                        <TextBox   Grid.Row="3" Grid.Column="3"
                                   Text="{Binding NumeroProveedor, UpdateSourceTrigger=PropertyChanged}"
                                   Margin="8,4,0,4"/>

                        <!-- Fila 5 -->
                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Dirección legal:" VerticalAlignment="Center"/>
                        <TextBox   Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="3"
                                   Text="{Binding DireccionLegal, UpdateSourceTrigger=PropertyChanged}"
                                   Margin="8,4,0,4"/>
                    </Grid>
                </Border>

                <!-- Relación de personal -->
<TextBlock Text="Relación de personal" Margin="0,16,0,6" FontWeight="SemiBold"/>

<Border BorderBrush="#D9D9D9" BorderThickness="1" CornerRadius="4" Background="White">
    <!-- Altura controlada + scroll interno del DataGrid -->
    <DataGrid ItemsSource="{Binding Personas}"
              SelectedItem="{Binding SelectedPerson, Mode=TwoWay}"
              AutoGenerateColumns="False"
              CanUserAddRows="False"
              CanUserDeleteRows="False"
              IsReadOnly="False"
              CanUserSortColumns="False"
              HeadersVisibility="Column"
              RowHeaderWidth="0"
              ColumnHeaderHeight="32"
              GridLinesVisibility="All"

              Height="230"                        
              ScrollViewer.VerticalScrollBarVisibility="Auto"
              ScrollViewer.CanContentScroll="True">

        <DataGrid.Columns>
            <DataGridTextColumn Header="No" Binding="{Binding Numero}" IsReadOnly="True" Width="40"/>
            <DataGridTextColumn Header="NOMBRE" Binding="{Binding Nombre, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
            <DataGridTextColumn Header="No. de Afiliación" Binding="{Binding Afiliacion, UpdateSourceTrigger=PropertyChanged}" Width="140"/>
            <DataGridTextColumn Header="Puesto" Binding="{Binding Puesto, UpdateSourceTrigger=PropertyChanged}" Width="160"/>

            <!-- Asistencia -->
            <DataGridTextColumn Header="D"  Binding="{Binding D,  UpdateSourceTrigger=PropertyChanged}" Width="42"/>
            <DataGridTextColumn Header="L"  Binding="{Binding L,  UpdateSourceTrigger=PropertyChanged}" Width="42"/>
            <DataGridTextColumn Header="M"  Binding="{Binding M,  UpdateSourceTrigger=PropertyChanged}" Width="42"/>
            <DataGridTextColumn Header="M"  Binding="{Binding MM, UpdateSourceTrigger=PropertyChanged}" Width="42"/>
            <DataGridTextColumn Header="J"  Binding="{Binding J,  UpdateSourceTrigger=PropertyChanged}" Width="42"/>
            <DataGridTextColumn Header="V"  Binding="{Binding V,  UpdateSourceTrigger=PropertyChanged}" Width="42"/>
            <DataGridTextColumn Header="S"  Binding="{Binding S,  UpdateSourceTrigger=PropertyChanged}" Width="42"/>

            <DataGridTextColumn Header="HH Semana" Binding="{Binding HHSemana}" IsReadOnly="True" Width="90"/>
        </DataGrid.Columns>
    </DataGrid>
</Border>


                <!-- Total HH (OneWay, evita intentar escribir TotalHH) -->
                <TextBlock HorizontalAlignment="Right"
           Margin="0,6,0,0"
           Text="{Binding Path=TotalHH, Mode=OneWay, StringFormat='TOTAL DE HH TRABAJADAS = {0}'}"/>




                <!-- Agregar / Editar -->
                <TextBlock Text="Agregar / editar personal" Margin="0,16,0,8" FontWeight="SemiBold"/>

                <Border Padding="12" BorderBrush="#E2E8F0" BorderThickness="1" CornerRadius="6" Background="White">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <!-- Nombre -->
                            <ColumnDefinition Width="1.2*"/>
                            <!-- Afiliación -->
                            <ColumnDefinition Width="1.2*"/>
                            <!-- Puesto -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- D -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- L -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- M -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- MM -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- J -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- V -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- S -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- Botones -->
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Etiquetas -->
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Nombre"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" Text="No. de Afiliación"/>
                        <TextBlock Grid.Row="0" Grid.Column="2" Text="Puesto"/>
                        <TextBlock Grid.Row="0" Grid.Column="3" HorizontalAlignment="Center" Text="D" Margin="0,4,6,0"/>
                        <TextBlock Grid.Row="0" Grid.Column="4" HorizontalAlignment="Center" Text="L" Margin="0,4,6,0"/>
                        <TextBlock Grid.Row="0" Grid.Column="5" HorizontalAlignment="Center" Text="M" Margin="0,4,6,0"/>
                        <TextBlock Grid.Row="0" Grid.Column="6" HorizontalAlignment="Center" Text="M" Margin="0,4,6,0"/>
                        <TextBlock Grid.Row="0" Grid.Column="7" HorizontalAlignment="Center" Text="J" Margin="0,4,6,0"/>
                        <TextBlock Grid.Row="0" Grid.Column="8" HorizontalAlignment="Center" Text="V" Margin="0,4,6,0"/>
                        <TextBlock Grid.Row="0" Grid.Column="9" HorizontalAlignment="Center" Text="S" Margin="0,4,6,0"/>

                        <!-- Campos -->
                        <TextBox Grid.Row="1" Grid.Column="0" Text="{Binding NewNombre, UpdateSourceTrigger=PropertyChanged}" Margin="0,4,8,0"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding NewAfiliacion, UpdateSourceTrigger=PropertyChanged}" Margin="0,4,8,0"/>
                        <TextBox Grid.Row="1" Grid.Column="2" Text="{Binding NewPuesto, UpdateSourceTrigger=PropertyChanged}" Margin="0,4,8,0"/>

                        <TextBox Grid.Row="1" Grid.Column="3" Width="36" HorizontalAlignment="Left" TextAlignment="Center" Text="{Binding NewD,  UpdateSourceTrigger=PropertyChanged}" Margin="0,4,6,0"/>
                        <TextBox Grid.Row="1" Grid.Column="4" Width="36" HorizontalAlignment="Left" TextAlignment="Center" Text="{Binding NewL,  UpdateSourceTrigger=PropertyChanged}" Margin="0,4,6,0"/>
                        <TextBox Grid.Row="1" Grid.Column="5" Width="36" HorizontalAlignment="Left" TextAlignment="Center" Text="{Binding NewM,  UpdateSourceTrigger=PropertyChanged}" Margin="0,4,6,0"/>
                        <TextBox Grid.Row="1" Grid.Column="6" Width="36" HorizontalAlignment="Left" TextAlignment="Center" Text="{Binding NewMM, UpdateSourceTrigger=PropertyChanged}" Margin="0,4,6,0"/>
                        <TextBox Grid.Row="1" Grid.Column="7" Width="36" HorizontalAlignment="Left" TextAlignment="Center" Text="{Binding NewJ,  UpdateSourceTrigger=PropertyChanged}" Margin="0,4,6,0"/>
                        <TextBox Grid.Row="1" Grid.Column="8" Width="36" HorizontalAlignment="Left" TextAlignment="Center" Text="{Binding NewV, UpdateSourceTrigger=PropertyChanged}" Margin="0,4,6,0"/>
                        <TextBox Grid.Row="1" Grid.Column="9" Width="36" HorizontalAlignment="Left" TextAlignment="Center" Text="{Binding NewS,  UpdateSourceTrigger=PropertyChanged}" Margin="0,4,6,0"/>

                        <!-- Botones -->
                        <StackPanel Grid.Row="1" Grid.Column="10" Orientation="Horizontal" HorizontalAlignment="Right" Margin="12,4,0,0">
                            <Button Content="Agregar" Margin="0,0,6,0" Padding="12,4" Command="{Binding AddPersonCommand}"/>
                            <Button Content="Guardar" Margin="0,0,6,0" Padding="12,4" Command="{Binding ApplyEditCommand}"/>
                            <Button Content="Eliminar" Margin="0,0,6,0" Padding="12,4" Command="{Binding DeleteSelectedCommand}"/>
                            
                        </StackPanel>
                    </Grid>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
